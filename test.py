import networkx as nx
import matplotlib.pyplot as plt

# Создаем граф
G = nx.DiGraph()

# Добавляем узлы (процессы, внешние сущности и хранилища данных)
G.add_node("Пользователь")
G.add_node("Просмотр и поиск активов")
G.add_node("Просмотр информации об активе")
G.add_node("Подписка на уведомления")
G.add_node("Управление избранными активами")
G.add_node("Настройки бота")
G.add_node("Получение помощи")
G.add_node("Пользователи")
G.add_node("Активы")
G.add_node("Избранные активы")
G.add_node("Подписки")

# Добавляем ребра (потоки данных)
G.add_edge("Пользователь", "Просмотр и поиск активов", label="Запрос на просмотр активов")
G.add_edge("Пользователь", "Просмотр информации об активе", label="Запрос на информацию об активе")
G.add_edge("Пользователь", "Подписка на уведомления", label="Настройка подписки")
G.add_edge("Пользователь", "Управление избранными активами", label="Добавление/удаление из избранного")
G.add_edge("Пользователь", "Настройки бота", label="Изменение настроек")
G.add_edge("Пользователь", "Получение помощи", label="Запрос помощи")

G.add_edge("Просмотр и поиск активов", "Активы", label="Запрос данных об активах")
G.add_edge("Просмотр информации об активе", "Активы", label="Запрос данных по активу")
G.add_edge("Подписка на уведомления", "Подписки", label="Сохранение подписки")
G.add_edge("Управление избранными активами", "Избранные активы", label="Обновление избранного")
G.add_edge("Настройки бота", "Пользователи", label="Обновление настроек")

G.add_edge("Активы", "Просмотр и поиск активов", label="Информация об активах")
G.add_edge("Активы", "Просмотр информации об активе", label="Информация об активе")
G.add_edge("Избранные активы", "Управление избранными активами", label="Обновленное избранное")
G.add_edge("Пользователи", "Настройки бота", label="Настройки пользователя")

# Настраиваем отображение
pos = nx.spring_layout(G)  # выбираем способ расположения узлов
plt.figure(figsize=(12, 8))

# Рисуем узлы и ребра графа
nx.draw(G, pos, with_labels=True, node_size=3000, node_color="lightblue", font_size=10, font_weight="bold", arrows=True)
edge_labels = nx.get_edge_attributes(G, 'label')
nx.draw_networkx_edge_labels(G, pos, edge_labels=edge_labels, font_size=8)

plt.title("DFD-диаграмма Telegram-бота")
plt.show()
